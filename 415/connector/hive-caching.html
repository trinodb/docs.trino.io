
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <link href="https://fonts.googleapis.com/css2?family=Alata&family=Open+Sans:ital,wght%400,300;0,400;0,600;1,400&display=swap" rel="stylesheet">
    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="../_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="../_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="2196f3">
  <script src="../_static/javascripts/modernizr.js"></script>
  
  
  
    <title>Hive connector storage caching &#8212; Trino 415 Documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/material.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/trino.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Hive connector with Alluxio" href="hive-alluxio.html" />
    <link rel="prev" title="Hive connector with IBM Cloud Object Storage" href="hive-cos.html" />
  
   

    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-133457846-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-133457846-1');
      gtag('config', 'AW-1036784065');
      window._linkedin_data_partner_ids = ['2842796'];
    </script>
    <script async src="https://snap.licdn.com/li.lms-analytics/insight.min.js"></script>
    <link rel=stylesheet href=https://use.fontawesome.com/releases/v5.8.2/css/all.css>
  </head>
  <body dir=ltr
        data-md-color-primary= data-md-color-accent=>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#connector/hive-caching" tabindex="1" class="md-skip"> Skip to content </a>
  <div id="announcement">
  <div id="announcement-content">
    <a href="https://github.com/trinodb/trino" target="_blank">
      Do you ‚ù§Ô∏è Trino? Give us a üåü on GitHub <i class="fab fa-github"></i>
    </a>
  </div>
</div>
<header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="/" title="Trino"
           class="md-header-nav__button md-logo">
          
              <img src="../_static/trino.svg" height="26"
                   alt="Trino 415 Documentation logo">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <span class="md-header-nav__topic">Trino 415 Documentation</span>
          <span class="md-header-nav__topic"> Hive connector storage caching </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" action="../search.html" method="GET" name="search">
      <input type="text" class="md-search__input" name="q" placeholder="Search"
             autocapitalize="off" autocomplete="off" spellcheck="false"
             data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>

      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            <a href="https://github.com/trinodb/trino" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    Trino
  </div>
</a>
          </div>
        </div>
      
      
  
  <script src="../_static/javascripts/version_dropdown.js"></script>
  <script>
    var json_loc = "../../versions.json",
        target_loc = "../../",
        text = "Versions";
    $( document ).ready( add_version_dropdown(json_loc, target_loc, text));
  </script>
  

    </div>
  </nav>
</header>

  
  <div class="md-container">
    
    
    <!-- empty -->
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="/" title="Trino" class="md-nav__button md-logo">
      
        <img src="../_static/trino.svg" alt=" logo" width="48" height="48">
      
    </a>
    <a href="../index.html"
       title="Trino 415 Documentation">Trino 415 Documentation</a>
  </label>
    <div class="md-nav__source">
      <a href="https://github.com/trinodb/trino" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    Trino
  </div>
</a>
    </div>
  
  

  
  <ul class="md-nav__list">
    <li class="md-nav__item">
    
    
      <a href="../overview.html" class="md-nav__link">Overview</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../installation.html" class="md-nav__link">Installation</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../client.html" class="md-nav__link">Clients</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../security.html" class="md-nav__link">Security</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../admin.html" class="md-nav__link">Administration</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../admin.html#event-listeners" class="md-nav__link">Event listeners</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../optimizer.html" class="md-nav__link">Query optimizer</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../connector.html" class="md-nav__link">Connectors</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="accumulo.html" class="md-nav__link">Accumulo</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="atop.html" class="md-nav__link">Atop</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="bigquery.html" class="md-nav__link">BigQuery</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="blackhole.html" class="md-nav__link">Black Hole</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="cassandra.html" class="md-nav__link">Cassandra</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="clickhouse.html" class="md-nav__link">ClickHouse</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="delta-lake.html" class="md-nav__link">Delta Lake</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="druid.html" class="md-nav__link">Druid</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="elasticsearch.html" class="md-nav__link">Elasticsearch</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="googlesheets.html" class="md-nav__link">Google Sheets</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="hive.html" class="md-nav__link">Hive</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="hive-security.html" class="md-nav__link">Security</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="hive-s3.html" class="md-nav__link">Amazon S3</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="hive-azure.html" class="md-nav__link">Azure Storage</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="hive-gcs-tutorial.html" class="md-nav__link">GCS Tutorial</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="hive-cos.html" class="md-nav__link">IBM Cloud Object Storage</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    <label class="md-nav__link md-nav__link--active" for="__toc"> Storage Caching </label>
    
      <a href="#" class="md-nav__link md-nav__link--active">Storage Caching</a>
      
        
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
    <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#benefits" class="md-nav__link">Benefits</a>
        </li>
        <li class="md-nav__item"><a href="#architecture" class="md-nav__link">Architecture</a>
        </li>
        <li class="md-nav__item"><a href="#configuration" class="md-nav__link">Configuration</a>
        </li>
        <li class="md-nav__item"><a href="#recommendations" class="md-nav__link">Recommendations</a>
        </li>
        <li class="md-nav__item"><a href="#object-storage-systems" class="md-nav__link">Object storage systems</a>
        </li>
        <li class="md-nav__item"><a href="#metrics" class="md-nav__link">Metrics</a>
        </li>
        <li class="md-nav__item"><a href="#limitations" class="md-nav__link">Limitations</a>
        </li>
    </ul>
</nav>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="hive-alluxio.html" class="md-nav__link">Alluxio</a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="hudi.html" class="md-nav__link">Hudi</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="iceberg.html" class="md-nav__link">Iceberg</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="ignite.html" class="md-nav__link">Ignite</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="jmx.html" class="md-nav__link">JMX</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="kafka.html" class="md-nav__link">Kafka</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="kinesis.html" class="md-nav__link">Kinesis</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="kudu.html" class="md-nav__link">Kudu</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="localfile.html" class="md-nav__link">Local File</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="mariadb.html" class="md-nav__link">MariaDB</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="memory.html" class="md-nav__link">Memory</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="mongodb.html" class="md-nav__link">MongoDB</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="mysql.html" class="md-nav__link">MySQL</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="oracle.html" class="md-nav__link">Oracle</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="phoenix.html" class="md-nav__link">Phoenix</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="pinot.html" class="md-nav__link">Pinot</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="postgresql.html" class="md-nav__link">PostgreSQL</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="prometheus.html" class="md-nav__link">Prometheus</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="redis.html" class="md-nav__link">Redis</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="redshift.html" class="md-nav__link">Redshift</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="memsql.html" class="md-nav__link">SingleStore</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="sqlserver.html" class="md-nav__link">SQL Server</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="system.html" class="md-nav__link">System</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="thrift.html" class="md-nav__link">Thrift</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="tpcds.html" class="md-nav__link">TPCDS</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="tpch.html" class="md-nav__link">TPCH</a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../functions.html" class="md-nav__link">Functions and operators</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../language.html" class="md-nav__link">SQL language</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../sql.html" class="md-nav__link">SQL statement syntax</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../develop.html" class="md-nav__link">Developer guide</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../glossary.html" class="md-nav__link">Glossary</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../appendix.html" class="md-nav__link">Appendix</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../release.html" class="md-nav__link">Release notes</a>
      
    
    </li>
  </ul>
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
    <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#benefits" class="md-nav__link">Benefits</a>
        </li>
        <li class="md-nav__item"><a href="#architecture" class="md-nav__link">Architecture</a>
        </li>
        <li class="md-nav__item"><a href="#configuration" class="md-nav__link">Configuration</a>
        </li>
        <li class="md-nav__item"><a href="#recommendations" class="md-nav__link">Recommendations</a>
        </li>
        <li class="md-nav__item"><a href="#object-storage-systems" class="md-nav__link">Object storage systems</a>
        </li>
        <li class="md-nav__item"><a href="#metrics" class="md-nav__link">Metrics</a>
        </li>
        <li class="md-nav__item"><a href="#limitations" class="md-nav__link">Limitations</a>
        </li>
    </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  <section id="hive-connector-storage-caching">
<h1 id="connector-hive-caching--page-root">Hive connector storage caching<a class="headerlink" href="#connector-hive-caching--page-root" title="Permalink to this heading">#</a></h1>
<p>Querying object storage with the <a class="reference internal" href="hive.html"><span class="doc">Hive connector</span></a> is a
very common use case for Trino. It often involves the transfer of large amounts
of data. The objects are retrieved from HDFS, or any other supported object
storage, by multiple workers and processed on these workers. Repeated queries
with different parameters, or even different queries from different users, often
access, and therefore transfer, the same objects.</p>
<section id="benefits">
<h2 id="benefits">Benefits<a class="headerlink" href="#benefits" title="Permalink to this heading">#</a></h2>
<p>Enabling caching can result in significant benefits:</p>
<p><strong>Reduced load on object storage</strong></p>
<p>Every retrieved and cached object avoids repeated retrieval from the storage in
subsequent queries. As a result the object storage system does not have to
provide the object again and again.</p>
<p>For example, if your query accesses 100MB of objects from the storage, the first
time the query runs 100MB are downloaded and cached. Any following query uses
these objects. If your users run another 100 queries accessing the same objects,
your storage system does not have to do any significant work. Without caching it
has to provide the same objects again and again, resulting in 10GB of total
storage to serve.</p>
<p>This reduced load on the object storage can also impact the sizing, and
therefore the cost, of the object storage system.</p>
<p><strong>Increased query performance</strong></p>
<p>Caching can provide significant performance benefits, by avoiding the repeated
network transfers and instead accessing copies of the objects from a local
cache. Performance gains are more significant if the performance of directly
accessing the object storage is low compared to accessing the cache.</p>
<p>For example, if you access object storage in a different network, different data
center or even different cloud-provider region query performance is slow. Adding
caching using fast, local storage has a significant impact and makes your
queries much faster.</p>
<p>On the other hand, if your object storage is already running at very high
performance for I/O and network access, and your local cache storage is at
similar speeds, or even slower, performance benefits can be minimal.</p>
<p><strong>Reduced query costs</strong></p>
<p>A result of the reduced load on the object storage, mentioned earlier, is
significantly reduced network traffic. Network traffic however is a considerable
cost factor in an setup, specifically also when hosted in public cloud provider
systems.</p>
</section>
<section id="architecture">
<h2 id="architecture">Architecture<a class="headerlink" href="#architecture" title="Permalink to this heading">#</a></h2>
<p>Caching can operate in two modes. The async mode provides the queried data
directly and caches any objects asynchronously afterwards. Async is the default
and recommended mode. The query doesn‚Äôt pay the cost of warming up the cache.
The cache is populated in the background and the query bypasses the cache if the
cache is not already populated. Any following queries requesting the cached
objects are served directly from the cache.</p>
<p>The other mode is a read-through cache. In this mode, if an object is not found
in the cache, it is read from the storage, placed in the cache, and then provided
to the requesting query. In read-through mode, the query always reads from cache
and must wait for the cache to be populated.</p>
<p>In both modes, objects are cached on local storage of each worker. Workers can
request cached objects from other workers to avoid requests from the object
storage.</p>
<p>The cache chunks are 1MB in size and are well suited for ORC or Parquet file
formats.</p>
</section>
<section id="configuration">
<h2 id="configuration">Configuration<a class="headerlink" href="#configuration" title="Permalink to this heading">#</a></h2>
<p>The caching feature is part of the <a class="reference internal" href="hive.html"><span class="doc">Hive connector</span></a> and
can be activated in the catalog properties file:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>connector.name=hive
hive.cache.enabled=true
hive.cache.location=/opt/hive-cache
</pre></div>
</div>
<p>The cache operates on the coordinator and all workers accessing the object
storage. The used networking ports for the managing BookKeeper and the data
transfer, by default 8898 and 8899, need to be available.</p>
<p>To use caching on multiple catalogs, you need to configure different caching
directories  and different BookKeeper and data-transfer ports.</p>
<table id="id1">
<caption><span class="caption-text"><strong>Cache Configuration Parameters</strong></span><a class="headerlink" href="#id1" title="Permalink to this table">#</a></caption>
<colgroup>
<col style="width: 25%"/>
<col style="width: 63%"/>
<col style="width: 12%"/>
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Property</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Default</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hive.cache.enabled</span></code></p></td>
<td><p>Toggle to enable or disable caching</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">false</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hive.cache.location</span></code></p></td>
<td><p>Required directory location to use for the cache storage on each worker.
Separate multiple directories, which can be mount points for separate
drives, with commas. More tips can be found in the <a class="reference internal" href="#hive-cache-recommendations"><span class="std std-ref">recommendations</span></a>. Example:
<code class="docutils literal notranslate"><span class="pre">hive.cache.location=/var/lib/trino/cache1,/var/lib/trino/cache2</span></code></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hive.cache.data-transfer-port</span></code></p></td>
<td><p>The TCP/IP port used to transfer data managed by the cache.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">8898</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hive.cache.bookkeeper-port</span></code></p></td>
<td><p>The TCP/IP port used by the BookKeeper managing the cache.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">8899</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hive.cache.read-mode</span></code></p></td>
<td><p>Operational mode for the cache as described earlier in the architecture
section. <code class="docutils literal notranslate"><span class="pre">async</span></code> and <code class="docutils literal notranslate"><span class="pre">read-through</span></code> are the supported modes.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">async</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">hive.cache.ttl</span></code></p></td>
<td><p>Time to live for objects in the cache. Objects, which have not been
requested for the TTL value, are removed from the cache.</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">7d</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">hive.cache.disk-usage-percentage</span></code></p></td>
<td><p>Percentage of disk space used for cached data.</p></td>
<td><p>80</p></td>
</tr>
</tbody>
</table>
</section>
<section id="recommendations">
<span id="hive-cache-recommendations"></span><h2 id="recommendations">Recommendations<a class="headerlink" href="#recommendations" title="Permalink to this heading">#</a></h2>
<p>The speed of the local cache storage is crucial to the performance of the cache.
The most common and cost efficient approach is to attach high performance SSD
disk or equivalents. Fast cache performance can be also be achieved with a RAM
disk used as in-memory.</p>
<p>In all cases, you should avoid using the root partition and disk of the node and
instead attach at multiple dedicated storage devices for the cache on each node.
The cache uses the disk up to a configurable percentage. Storage should be local
on each coordinator and worker node. The directory needs to exist before Trino
starts. We recommend using multiple devices to improve performance of the cache.</p>
<p>The capacity of the attached storage devices should be about 20-30% larger than
the size of the queried object storage workload. For example, your current query
workload typically accesses partitions in your HDFS storage that encapsulate
data for the last 3 months. The overall size of these partitions is currently at
1TB. As a result your cache drives have to have a total capacity of 1.2 TB or
more.</p>
<p>Your deployment method for Trino decides how to create the directory for
caching. Typically you need to connect a fast storage system, like an SSD drive,
and ensure that is it mounted on the configured path. Kubernetes, CFT and other
systems allow this via volumes.</p>
</section>
<section id="object-storage-systems">
<h2 id="object-storage-systems">Object storage systems<a class="headerlink" href="#object-storage-systems" title="Permalink to this heading">#</a></h2>
<p>The following object storage systems are tested:</p>
<ul class="simple">
<li><p>HDFS</p></li>
<li><p><a class="reference internal" href="hive-s3.html"><span class="doc">Amazon S3 and S3-compatible systems</span></a></p></li>
<li><p><a class="reference internal" href="hive-azure.html"><span class="doc">Azure storage systems</span></a></p></li>
<li><p>Google Cloud Storage</p></li>
</ul>
</section>
<section id="metrics">
<h2 id="metrics">Metrics<a class="headerlink" href="#metrics" title="Permalink to this heading">#</a></h2>
<p>In order to verify how caching works on your system you can take multiple
approaches:</p>
<ul class="simple">
<li><p>Inspect the disk usage on the cache storage drives on all nodes</p></li>
<li><p>Query the metrics of the caching system exposed by JMX</p></li>
</ul>
<p>The implementation of the cache exposes a <a class="reference external" href="https://rubix.readthedocs.io/en/latest/metrics.html">number of metrics</a> via JMX. You can
<a class="reference internal" href="../admin/jmx.html"><span class="doc">inspect these and other metrics directly in Trino with the JMX connector
or in external tools</span></a>.</p>
<p>Basic caching statistics for the catalog are available in the
<code class="docutils literal notranslate"><span class="pre">jmx.current."rubix:catalog=&lt;catalog_name&gt;,name=stats"</span></code> table.
The table <code class="docutils literal notranslate"><span class="pre">jmx.current."rubix:catalog=&lt;catalog_name&gt;,type=detailed,name=stats</span></code>
contains more detailed statistics.</p>
<p>The following example query returns the average cache hit ratio for the <code class="docutils literal notranslate"><span class="pre">hive</span></code> catalog:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span> <span class="k">avg</span><span class="p">(</span><span class="n">cache_hit</span><span class="p">)</span>
<span class="k">FROM</span> <span class="n">jmx</span><span class="p">.</span><span class="k">current</span><span class="p">.</span><span class="ss">"rubix:catalog=hive,name=stats"</span>
<span class="k">WHERE</span> <span class="k">NOT</span> <span class="n">is_nan</span><span class="p">(</span><span class="n">cache_hit</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="limitations">
<h2 id="limitations">Limitations<a class="headerlink" href="#limitations" title="Permalink to this heading">#</a></h2>
<p>Caching does not support user impersonation and cannot be used with HDFS secured by Kerberos.
It does not take any user-specific access rights to the object storage into account.
The cached objects are simply transparent binary blobs to the caching system and full
access to all content is available.</p>
</section>
</section>


          </article>
        </div>
      </div>
    </main>
  </div>
  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
            <a href="hive-cos.html" title="Hive connector with IBM Cloud Object Storage"
               class="md-flex md-footer-nav__link md-footer-nav__link--prev"
               rel="prev">
              <div class="md-flex__cell md-flex__cell--shrink">
                <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
              </div>
              <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
                <span class="md-flex__ellipsis">
                  <span
                      class="md-footer-nav__direction"> Previous </span> Hive connector with IBM Cloud Object Storage </span>
              </div>
            </a>
          
          
            <a href="hive-alluxio.html" title="Hive connector with Alluxio"
               class="md-flex md-footer-nav__link md-footer-nav__link--next"
               rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span
                class="md-flex__ellipsis"> <span
                class="md-footer-nav__direction"> Next </span> Hive connector with Alluxio </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink"><i
                class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
        </div>
      </div>
    </div>
  </footer>
  <script src="../_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>
  </body>
</html>